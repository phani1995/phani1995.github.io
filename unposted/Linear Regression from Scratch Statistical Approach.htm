<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:24.0pt;
	font-family:"Calibri",sans-serif;}
h2
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;}
h3
	{margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri",sans-serif;}
h4
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
h5
	{margin-top:11.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h6
	{margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:36.0pt;
	font-family:"Calibri",sans-serif;
	font-weight:bold;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:24.0pt;
	font-family:"Georgia",serif;
	color:#666666;
	font-style:italic;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US>

<div class=WordSection1>

<p class=MsoNormal><span style='font-size:24.0pt;line-height:107%'>Linear
Regression from Scratch Statistical Approach</span></p>

<p class=MsoNormal><span style='font-size:24.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal><img width=672 height=463 id=image9.png
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image001.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><b><span style='font-size:18.0pt;
line-height:107%'>The Theory</span></b></p>

<p class=MsoNormal>Linear Regression is the process of fitting a line to the
dataset.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Single
Variable Linear Regression</span></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>The
Mathematics</span></b></p>

<p class=MsoNormal>The equation of Line is</p>

<p class=MsoNormal><img width=92 height=12 id=image11.png
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image002.png"
alt="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#xA0;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#xA0;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#xB7;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow/&gt;&lt;/msub&gt;&lt;/math&gt;"></p>

<p class=MsoNormal>Where,</p>

<p class=MsoNormal> y = dependent variable</p>

<p class=MsoNormal> X = independent variable</p>

<p class=MsoNormal>C = intercept </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The algorithm is trying to fit a line to the data by
adjusting the values of m and c. Its Objective is to attain to a value of m
such that for any given value of x it would be properly predicting the value of
y.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>There are various ways in which we can attain the values of
m and c </p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
     115%;border:none'><span style='font-family:"Arial",sans-serif;color:black'>Statistical
     approach</span></li>
 <li class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
     115%;border:none'><span style='font-family:"Arial",sans-serif;color:black'>Iterative
     approach</span></li>
</ol>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>In this post we are discussing Statistical approach. If you
find the derivation too long you can take look ar final m and c formulas.</p>

<p class=MsoNormal>We were given data, set of x and y values and we were asked
to find a line which best fits that which means mathematically we should be
able to fine the slope and c values of the line to describe the line.</p>

<p class=MsoNormal>The derivation to the slope and intercept values of the line</p>

<p class=MsoNormal>The equation of the Line is</p>

<p class=MsoNormal><span style='font-size:11.0pt;line-height:107%;font-family:
"Calibri",sans-serif'><img width=69 height=19
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image003.png"></span></p>

<p class=MsoNormal>Which means for a particular value of x, let us say x<sub>i </sub>the
value of y would be y<sub>i</sub> = m*x<sub>i </sub>+ c</p>

<p class=MsoNormal>For x<sub>1 </sub>value of x y<sub>1 </sub>value of y is
obtained,</p>

<p class=MsoNormal>For x<sub>2 </sub>value of x y<sub>2 </sub>value of y is
obtained,</p>

<p class=MsoNormal>And goes on </p>

<p class=MsoNormal>On summating all these values into one equation, it can be
written as,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=167 height=49
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image004.png"></span></p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=212 height=49
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image005.png"></span></p>

<p class=MsoNormal>The objective is to solve equation 1 and 2 to attain the
values of c and m</p>

<p class=MsoNormal>On solving the c term in Equation 1, it can also be written
as,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=171 height=49
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image006.png"></span></p>

<p class=MsoNormal>Rewriting it as,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=128 height=40
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image007.png"></span></p>

<p class=MsoNormal>Substituting the value of m in Equation 2</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=306 height=49
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image008.png"></span></p>

<p class=MsoNormal>Now only c is there in Equation 3, solving for c </p>

<p class=MsoNormal>Step1,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=355 height=49
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image009.png"></span></p>

<p class=MsoNormal>Step2,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=403 height=58
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image010.png"></span></p>

<p class=MsoNormal>Step 3,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=266 height=47
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image011.png"></span></p>

<p class=MsoNormal>On multiplying both numerator and denominator by -1</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=266 height=47
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image012.png"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>To calculate the value of m taking the value of c and
substituting in Equation -1,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=418 height=50
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image013.png"></span></p>

<p class=MsoNormal>Equation 4 have only one parameter m, so solving for m,</p>

<p class=MsoNormal><span style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=624 height=116
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image014.png"></span></p>

<p class=MsoNormal>On expanding RHS and cancelling terms, </p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=502 height=58
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image015.png"></span></p>

<p class=MsoNormal>The value of m,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=237 height=45
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image016.png"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The values of c and m are,</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=237 height=45
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image016.png"></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
width=266 height=47
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image012.png"></span></p>

<p class=MsoNormal>We use the m and c formulas obtained in derivation in the
code.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>The
Dataset</span></b><span style='font-size:18.0pt;line-height:107%'> </span></p>

<p class=MsoNormal>Dataset consists of two columns namely X and y</p>

<p class=MsoNormal>Where</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>For <span style='background:white'>List Price Vs. Best Price
for a New GMC Pickup</span> dataset</p>

<p class=MsoNormal>X = <span style='background:white'>List price (in $1000) for
a GMC pickup truck</span></p>

<p class=MsoNormal>Y = <span style='background:white'>Best price (in $1000) for
a GMC pickup truck</span></p>

<p class=MsoNormal>The data is taken from <i><span style='background:white'>Consumers
Digest.</span></i></p>

<p class=MsoNormal><i><span style='background:white'>&nbsp;</span></i></p>

<p class=MsoNormal>For Fire and Theft in Chicago </p>

<p class=MsoNormal>X = fires per 100 housing units</p>

<p class=MsoNormal>Y = thefts per 1000 population within the same Zip code in
the Chicago metro area</p>

<p class=MsoNormal>The data is taken from U.S Commission of Civil Rights.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>For Auto Insurance in Sweden dataset</p>

<p class=MsoNormal>X = number of claims</p>

<p class=MsoNormal>Y = total payment for all the claims in thousands of Swedish
Kronor</p>

<p class=MsoNormal>The data is taken from Swedish Committee on Analysis of Risk
Premium in Motor Insurance.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>For Gray Kangaroos dataset</p>

<p class=MsoNormal>X = <span style='background:white'>nasal length (mm ¥10)</span></p>

<p class=MsoNormal>Y = <span style='background:white'>nasal width (mm ¥ 10)</span><br>
<span style='background:white'>for a male gray kangaroo from a random sample of
such animals</span></p>

<p class=MsoNormal>The data is taken from <span style='background:white'>Australian<i>
Journal of Zoology</i>, Vol. 28, p607-613.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><u><span style='color:#0563C1'><a
href="http://college.cengage.com/mathematics/brase/understandable_statistics/7e/students/datasets/slr/frames/frame.html"><span
style='color:#0563C1'>Link to All Datasets</span></a></span></u></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><b><span style='font-size:18.0pt;
line-height:107%'>The Code</span></b></p>

<p class=MsoNormal style='text-align:justify'>The Code was written in three
phases</p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormalCxSpMiddle style='margin-bottom:0in;margin-bottom:.0001pt;
     text-align:justify;line-height:115%'>Data preprocessing phase</li>
 <li class=MsoNormalCxSpMiddle style='margin-bottom:0in;margin-bottom:.0001pt;
     text-align:justify;line-height:115%'>Training</li>
 <li class=MsoNormalCxSpMiddle style='margin-bottom:0in;margin-bottom:.0001pt;
     text-align:justify;line-height:115%'>Prediction and plotting</li>
</ol>

<p class=MsoNormal style='text-align:justify'><br>
<b><span style='font-size:18.0pt;line-height:107%'>The data preprocessing phase</span></b></p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Imports </span></b></p>

<p class=MsoNormal>Numpy import for array processing, python doesnt have built
in array support. The feature of working with native arrays can be used in
python with the help of numpy library.</p>

<p class=MsoNormal>Pandas is a library of python used for working with tables,
on importing the data, mostly data will be of table format, for ease
manipulation of tables pandas library is imported</p>

<p class=MsoNormal>Matplotlib is a library of python used to plot graphs, for
the purpose of visualizing the results we would be plotting the results with
the help of matplotlib library.</p>

<p class=MsoNormal>Math library is import for calculating powers of numbers.</p>

<table class=a border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'># Imports</span><span style='font-family:Consolas;color:#F8F8F2;
  background:#282A36'><br>
  </span><b><span style='font-family:Consolas;color:#8BE9FD;background:#282A36'>import</span></b><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'> numpy </span><b><span
  style='font-family:Consolas;color:#8BE9FD;background:#282A36'>as</span></b><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'> np<br>
  </span><b><span style='font-family:Consolas;color:#8BE9FD;background:#282A36'>import</span></b><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'> pandas </span><b><span
  style='font-family:Consolas;color:#8BE9FD;background:#282A36'>as</span></b><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'> pd<br>
  </span><b><span style='font-family:Consolas;color:#8BE9FD;background:#282A36'>import</span></b><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'>
  matplotlib.pyplot </span><b><span style='font-family:Consolas;color:#8BE9FD;
  background:#282A36'>as</span></b><span style='font-family:Consolas;
  color:#F8F8F2;background:#282A36'> plt<br>
  </span><b><span style='font-family:Consolas;color:#8BE9FD;background:#282A36'>import</span></b><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'> math</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Reading
the dataset from data</span></b></p>

<p class=MsoNormal>In this line of code using the read_excel method of pandas
library, the dataset has been imported from data folder and stored in dataset
variable.</p>

<p class=MsoNormal>&nbsp;</p>

<table class=a0 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'># Reading the dataset from data</span><span style='font-family:Consolas;
  color:#F8F8F2;background:#282A36'><br>
  dataset = pd.read_csv(</span><span style='font-family:Consolas;color:#F1FA8C;
  background:#282A36'>r'..\\data\\auto_insurance.csv'</span><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'>)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>On viewing the dataset, it contains of two columns X and Y
where X is dependent variable and Y is Independent Variable</p>

<p class=MsoNormal><img width=165 height=129
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image017.png"
align=left hspace=12 vspace=12></p>

<p class=MsoNormal>X is an independent variable </p>

<p class=MsoNormal>Y is dependent variable Inference</p>

<p class=MsoNormal>For x-value of 7.6 ,157 y-value </p>

<p class=MsoNormal>for   x-value of 7.1 ,174 y-value</p>

<p class=MsoNormal>And goes on</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Creating
Dependent and Independent variables</span></b></p>

<p class=MsoNormal>The X Column from the dataset is extracted into an X variable
of type numpy, similarly the y variable</p>

<p class=MsoNormal>X is an independent variable </p>

<p class=MsoNormal>Y is dependent variable Inference</p>

<table class=a1 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'># Creating Dependent and Independent variables</span><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'><br>
  X = dataset[</span><span style='font-family:Consolas;color:#F1FA8C;
  background:#282A36'>'X'</span><span style='font-family:Consolas;color:#F8F8F2;
  background:#282A36'>].values<br>
  y = dataset[</span><span style='font-family:Consolas;color:#F1FA8C;
  background:#282A36'>'Y'</span><span style='font-family:Consolas;color:#F8F8F2;
  background:#282A36'>].values</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=256 height=87
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image018.png"
align=left hspace=12 vspace=12></p>

<p class=MsoNormal>On input 10 it would result in a pandas Series object</p>

<p class=MsoNormal>So, values attribute is used to attain an numpy array</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Visualizing
the data </span></b></p>

<p class=MsoNormal>The step is to just see how the dataset is </p>

<p class=MsoNormal>On visualization the data would appear something like this</p>

<table class=a2 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'># Visualizing the data </span><span style='font-family:Consolas;
  color:#F8F8F2;background:#282A36'><br>
  title=</span><span style='font-family:Consolas;color:#F1FA8C;background:#282A36'>'Linear
  Regression on &lt;Dataset&gt;'</span><span style='font-family:Consolas;
  color:#F8F8F2;background:#282A36'><br>
  x_axis_label = </span><span style='font-family:Consolas;color:#F1FA8C;
  background:#282A36'>'X-value &lt; The corresponding attribute of X in dataset
  &gt;'</span><span style='font-family:Consolas;color:#F8F8F2;background:#282A36'><br>
  y_axis_label = </span><span style='font-family:Consolas;color:#F1FA8C;
  background:#282A36'>'y-value &lt; The corresponding attribute of X in dataset
  &gt;'</span><span style='font-family:Consolas;color:#F8F8F2;background:#282A36'><br>
  plt.scatter(X,y)<br>
  plt.title(title)<br>
  plt.xlabel(x_axis_label)<br>
  plt.ylabel(y_axis_label)<br>
  plt.show()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=494 height=347
src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image019.jpg"
align=left hspace=12></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>  </p>

<p class=MsoNormal>Each point on the plot is a data point showing the
respective list price on x-axis and Best Price on y-axis</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The X and Y attributes would vary based on dataset.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Splitting
the data into training set and test set</span></b></p>

<p class=MsoNormal>We are splitting the whole dataset into training and test
set where training set is used for fitting the line to data and test set is
used to check how good the line if for the data.</p>

<p class=MsoNormal>&nbsp;</p>

<table class=a3 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'># Splitting the data into training set and test set</span><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'><br>
  X_train,X_test = np.split(X,indices_or_sections = [int(len(X)*0.8)])<br>
  y_train,y_test = np.split(y,indices_or_sections = [int(len(X)*0.8)])</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><b><span style='font-size:18.0pt;
line-height:107%'>The Training phase</span></b></p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Computing
the values of sigma</span></b></p>

<p class=MsoNormal>As per the derivation formula we are computing the values of
sigma x sigma x^2 sigma y sigma x*y</p>

<p class=MsoNormal>n is the number of terms in the dataset.</p>

<table class=a2 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal><span style='font-family:Consolas;color:#6272A4;
  background:#282A36'># Computing the values of sigma</span><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'><br>
  sigma_X = sum(X_train)<br>
  sigma_y = sum(y_train)<br>
  sigma_xy = sum(np.multiply(X_train,y_train))<br>
  sigma_X_square = sum(np.square(X_train))<br>
  n = len(X_train)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Computing
the values of Slope and Intercept</span></b></p>

<p class=MsoNormal>As our linear regression model requires a slope and
intercept, we are computing their values using statistical formulas.</p>

<table class=a2 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal><span style='font-family:Consolas;color:#6272A4;
  background:#282A36'># Computing the values of slope and intercept </span><span
  style='font-family:Consolas;color:#F8F8F2;background:#282A36'><br>
  m_numerator = (n*sigma_xy)-(sigma_X*sigma_y)<br>
  m_denominator =  n*sigma_X_square - math.pow(sigma_X,2)<br>
  m = m_numerator/m_denominator<br>
  <br>
  c_numerator = (sigma_y*sigma_X_square)-(sigma_xy*sigma_X)<br>
  c_denominator = (n*sigma_X_square) - math.pow(sigma_X,2)<br>
  c = c_numerator/c_denominator</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>The
Prediction phase</span></b></p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Predicting
the Results</span></b></p>

<p class=MsoNormal>By the knowing the slope and intercept values of linear
regression model we are trying to predict the values of test data. Y_pred
variable contains all the predicted y-values of the test x-values.</p>

<p class=MsoNormal>&nbsp;</p>

<table class=a6 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=370 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'># Predicting the Results</span><span style='font-family:Consolas;
  color:#F8F8F2;background:#282A36'><br>
  y_pred = X_test*m + c</span></p>
  </td>
  <td width=331 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'>&nbsp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal><a name="_gjdgxs"></a><b><span style='font-size:18.0pt;
line-height:107%'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span style='font-size:18.0pt;line-height:107%'>Visualizing
the Results</span></b></p>

<p class=MsoNormal>As we have predicted the y-values for a set of x-values we
are visualizing the results to check how good did our line fit for our
predictions.</p>

<p class=MsoNormal>The plot shows the red points are the data points are actual
values where the blue line is the predictions.</p>

<p class=MsoNormal>&nbsp;</p>

<table class=a7 border=0 cellspacing=0 cellpadding=0 style='margin-left:5.0pt;
 border-collapse:collapse'>
 <tr>
  <td width=624 valign=top style='width:6.5in;background:#282A36;padding:5.0pt 5.0pt 5.0pt 5.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  115%;border:none'><span style='font-family:Consolas;color:#6272A4;background:
  #282A36'># Visualizing the Results</span><span style='font-family:Consolas;
  color:#F8F8F2;background:#282A36'><br>
  plt.scatter(X_test,y_test,c=</span><span style='font-family:Consolas;
  color:#F1FA8C;background:#282A36'>'red'</span><span style='font-family:Consolas;
  color:#F8F8F2;background:#282A36'>)<br>
  plt.plot(X_test,y_pred)<br>
  plt.title(title)<br>
  plt.xlabel(x_axis_label)<br>
  plt.ylabel(y_axis_label)<br>
  plt.show()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>

<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=51 height=0></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=523 height=371
  src="Linear%20Regression%20from%20Scratch%20Statistical%20Approach_files/image020.jpg"></td>
 </tr>
</table>

<br clear=ALL>
</p>

</div>

</body>

</html>
